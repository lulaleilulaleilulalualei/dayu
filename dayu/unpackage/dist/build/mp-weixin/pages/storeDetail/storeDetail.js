(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/storeDetail/storeDetail"],{5310:function(t,e,s){},5974:function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(s("1b42")),a=r(s("38b6")),i=r(s("95cf")),n=s("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{},o=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable}))),o.forEach(function(e){d(t,e,s[e])})}return t}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var l={data:function(){return{isShowSkeleton:!0,id:null,detailObj:{},storeImgs:[],startTime:"",endTime:"",isLoadErr:!1,isShowAccreditBox:!1,isSharePage:this.$isSharePage,isAuth:!1}},components:{loadErr:a.default,skeleton:o.default,backHome:i.default},onLoad:function(t){this.id=t.id,this.getDetailData(),this.$userInfo&&(this.isAuth=!0)},onShow:function(){this.c_toSaveStoreInfo({})},methods:c({},(0,n.mapActions)(["c_toSaveStoreInfo"]),{toPriviewImg:function(e){var s=this;t.previewImage({current:s.storeImgs[e],urls:s.storeImgs})},getUserInfo:function(e){if("getUserInfo:ok"==e.detail.errMsg){t.showLoading({title:"授权登陆中...",mask:!0});var s=this;this.$api.userLogin(function(e){"1"==e&&(t.hideLoading(),t.showToast({title:"授权登录成功",icon:"success",mask:!0,success:function(){s.isAuth=!0,1==s.detailObj.goods_type?(t.showLoading({title:"正在调用支付...",mask:!0}),s.toBuyCoupon()):(s.c_toSaveStoreInfo(s.detailObj),t.navigateTo({url:"/pages/receiverAddress/receiverAddress"}))}}))})}else this.$api.warnNotice("您已拒绝授权！"),this.isAuth=!1},toRelaodData:function(){this.isLoadErr=!1,this.detailObj={},this.storeImgs=[],this.getDetailData()},getDetailData:function(){var t=this;this.$api.ajax({url:this.$config.storeDetail,data:{goods_id:this.id}}).then(function(e){200==e.statusCode&&0==e.data.code?(t.detailObj=e.data.data,0==t.detailObj.goods_type?t.storeImgs=t.detailObj.picture_arr.split(","):1==t.detailObj.goods_type&&(t.startTime=t.detailObj.expire_start_date.split(" ")[0].replace(/-/g,"/"),t.endTime=t.detailObj.expire_end_date.split(" ")[0].replace(/-/g,"/")),setTimeout(function(){t.isShowSkeleton=!1},200)):(t.isShowSkeleton=!1,t.api.warnNotice(e.data.message),t.isLoadErr=!0)}).catch(function(){t.isShowSkeleton=!1,t.isLoadErr=!0})},bindToBuyStore:function(){1==this.detailObj.goods_type?(t.showLoading({title:"正在调用支付...",mask:!0}),this.toBuyCoupon()):(this.c_toSaveStoreInfo(this.detailObj),t.navigateTo({url:"/pages/receiverAddress/receiverAddress"}))},toBuyCoupon:function(){var e=this,s=this;this.$api.ajax({url:this.$config.buyStore,method:"POST",data:{uid:this.$userInfo.uid,openid:this.$userInfo.openid,goods_id:this.detailObj.goods_id,buy_num:1,buy_json:JSON.stringify({proName:s.detailObj.goods_name,proPrice:s.detailObj.goods_price,proImg:s.detailObj.goods_thumb,tips:s.detailObj.goods_tips,type:s.detailObj.goods_type,expireStart:s.detailObj.expire_start_date,expireEnd:s.detailObj.expire_end_date})}}).then(function(s){200==s.statusCode&&0==s.data.code?(wx.hideLoading(),t.requestPayment({timeStamp:s.data.data.timeStamp,nonceStr:s.data.data.nonceStr,package:s.data.data.package,signType:s.data.data.signType,paySign:s.data.data.paySign,success:function(e){"requestPayment:ok"==e.errMsg&&t.showToast({title:"支付成功",icon:"success",success:function(){setTimeout(function(){wx.navigateTo({url:"/pages/orderDetail/orderDetail?id=".concat(s.data.data.buy_id)})},1500)}})},fail:function(t){e.$api.warnNotice("支付失败")}})):(wx.hideLoading(),e.$api.warnNotice(s.data.message))}).catch(function(t){wx.hideLoading(),e.$api.warnNotice("购买失败")})}}),onShareAppMessage:function(){var t=this;return{path:"/pages/storeDetail/storeDetail?id=".concat(t.id),title:t.detailObj.goods_name,imageUrl:t.detailObj.goods_thumb}}};e.default=l}).call(this,s("543d")["default"])},b4df:function(t,e,s){"use strict";var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",{staticClass:"storeDetail"},[t.isShowSkeleton?o("skeleton",{attrs:{mpcomid:"ed7a5576-0"}}):t._e(),o("cu-custom",{attrs:{bgColor:"white",isBack:!t.isSharePage,mpcomid:"ed7a5576-1"}},[o("block",{slot:"content"},[t._v("商品详情")])],1),o("view",{staticClass:"contentBox"},[o("scroll-view",{staticClass:"scrollBox",attrs:{"scroll-y":!t.isShowSkeleton}},[t.isShowSkeleton?o("view",{staticClass:"storeBanner skeleton-rect"}):t._e(),0==t.detailObj.goods_type?o("view",{staticClass:"storeBanner"},[o("swiper",{staticClass:"storeSwiperBox",attrs:{"indicator-dots":!0,autoplay:!0,interval:3e3,duration:800}},t._l(t.storeImgs,function(e,s){return o("block",{key:s},[o("swiper-item",{attrs:{mpcomid:"ed7a5576-2-"+s}},[o("view",{staticClass:"itemStoreBanner",attrs:{eventid:"ed7a5576-0-"+s},on:{click:function(e){t.toPriviewImg(s)}}},[o("image",{attrs:{src:e,mode:"aspectFill"}})])])],1)}))],1):t._e(),1==t.detailObj.goods_type?o("view",{staticClass:"showCouponBox"},[o("view",{staticClass:"couponBoxBg"},[o("img",{attrs:{src:s("bbd9"),alt:""}})]),o("view",{staticClass:"couponBoxInfo"},[o("view",{staticClass:"showCouponInfoBox"},[o("view",{staticClass:"couponNamePrice"},[o("view",{staticClass:"showCouponName"},[t._v(t._s(t.detailObj.goods_name))]),o("view",{staticClass:"showCouponPrice"},[o("text",[t._v(t._s(t.detailObj.goods_price))]),t._v("元")])]),o("view",{staticClass:"showCouponNotice"},[t._v("仅限该商品，限柳叶湖使用")])])])]):t._e(),o("view",{staticClass:"showTxtContent"},[o("view",{staticClass:"showStoreInfo"},[o("view",{staticClass:"showStoreName"},[o("text",{staticClass:"skeleton-rect"},[t._v(t._s(t.detailObj.goods_name))])]),o("view",{staticClass:"showStorePrice"},[o("view",{staticClass:"showCurStorePri skeleton-rect"},[t._v("￥"),o("text",[t._v(t._s(t.detailObj.goods_price))]),t._v("元")]),t.detailObj.cost_price?o("view",{staticClass:"showBefStorePri skeleton-rect"},[t._v("原价"+t._s(t.detailObj.cost_price)+"元")]):t._e()]),0==t.detailObj.goods_type&&t.detailObj.goods_tips?o("view",{staticClass:"showStoreOtherInfo skeleton-rect"},[t._v(t._s(t.detailObj.goods_tips))]):t._e(),1==t.detailObj.goods_type?o("view",{staticClass:"showStoreOtherInfo skeleton-rect"},[t._v("有效期："+t._s(t.startTime)+" 至 "+t._s(t.endTime))]):t._e()]),o("view",{staticClass:"showStoreDetail"},[o("view",{staticClass:"showStoreTitle"},[o("text",{staticClass:"skeleton-rect"},[t._v("商品详情")])]),o("view",{staticClass:"showStoreDetailBox skeleton-rect"},[t._v(t._s(t.detailObj.goods_desc))])]),o("view",{staticClass:"showStoreIntro"},[o("view",{staticClass:"showStoreTitle"},[o("text",{staticClass:"skeleton-rect"},[t._v("重要声明")])]),o("view",{staticClass:"showStoreIntroBox skeleton-rect"},[t._v(t._s(t.detailObj.important_explain))])])])])],1),o("view",{staticClass:"toBuyStoreBtn"},[o("view",{attrs:{eventid:"ed7a5576-1"},on:{click:t.bindToBuyStore}},[t._v("立即购买")]),t.isAuth?t._e():o("button",{staticClass:"toAuthBtn",attrs:{"open-type":"getUserInfo",lang:"zh_CN",eventid:"ed7a5576-2"},on:{getuserinfo:t.getUserInfo}},[t._v("授权")])],1),t.isLoadErr?o("loadErr",{attrs:{eventid:"ed7a5576-3",mpcomid:"ed7a5576-3"},on:{toRelaodData:t.toRelaodData}}):t._e(),t.isSharePage?o("backHome",{attrs:{mpcomid:"ed7a5576-4"}}):t._e()],1)},a=[];s.d(e,"a",function(){return o}),s.d(e,"b",function(){return a})},b6be:function(t,e,s){"use strict";var o=s("5310"),a=s.n(o);a.a},b862:function(t,e,s){"use strict";s.r(e);var o=s("5974"),a=s.n(o);for(var i in o)"default"!==i&&function(t){s.d(e,t,function(){return o[t]})}(i);e["default"]=a.a},e5e6:function(t,e,s){"use strict";s("9010");var o=i(s("b0ce")),a=i(s("f616"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,o.default)(a.default))},f616:function(t,e,s){"use strict";s.r(e);var o=s("b4df"),a=s("b862");for(var i in a)"default"!==i&&function(t){s.d(e,t,function(){return a[t]})}(i);s("b6be");var n=s("2877"),r=Object(n["a"])(a["default"],o["a"],o["b"],!1,null,"e10176a6",null);e["default"]=r.exports}},[["e5e6","common/runtime","common/vendor"]]]);